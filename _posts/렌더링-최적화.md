---
title: 'ë Œë”ë§ ìµœì í™”ì˜ ê¸°ë³¸ (useCallback, React Memo)'
category: 'React ê°œë°œ-ê³µë¶€'
description: "ë Œë”ë§ ìµœì í™”ì— í•„ìš”í•œ useCallback, React.Memoì— ëŒ€í•´ì„œ ë°°ì›ë‹ˆë‹¤."
coverImage: '/assets/blog/ë Œë”ë§-ìµœì í™”/rendering.png'
date: '2021-01-26T05:35:07.322Z'
ogImage:
  url: '/assets/blog/dynamic-routing/cover.jpg'
---

> [ì°¸ì¡°ë§í¬]

[ì°¸ì¡°ë§í¬]: https://dmitripavlutin.com/use-react-memo-wisely

## í•¨ìˆ˜ ë©”ëª¨ì´ì œì´ì…˜(memoization)
[ë©”ëª¨ì´ì œì´ì…˜](https://ko.wikipedia.org/wiki/%EB%A9%94%EB%AA%A8%EC%9D%B4%EC%A0%9C%EC%9D%B4%EC%85%98)ì€ ì»´í“¨í„°ê°€ ë°˜ë³µì ìœ¼ë¡œ ì—°ì‚°í•´ì•¼í•˜ëŠ” íŠ¹ì • ê°’ì„ ë©”ëª¨ë¦¬ì— ì €ì¥í•˜ì—¬ ì¬ì‚¬ìš©í•¨ìœ¼ë¡œì¨ ì—°ì‚° ì†ë„ë¥¼ ë†’ì—¬ì£¼ëŠ” ê¸°ìˆ ì´ë‹¤.
**useCallback()** ì€ ì½œë°± í•¨ìˆ˜ë¥¼ ë©”ëª¨ì´ì œì´ì…˜(memoization)í•˜ëŠ”ë° ì‚¬ìš©ë˜ëŠ” hook ë‚´ì¥ í•¨ìˆ˜ì´ë‹¤. ì²« ë²ˆì§¸ ì¸ìë¡œ ë“¤ì–´ì˜¨ í•¨ìˆ˜ë¥¼ ë‘ ë²ˆì§¸ ì¸ìë¡œ ë“¤ì–´ì˜¨ ë°°ì—´ì˜ ì›ì†Œì˜ ê°’ì´ ë³€ê²½ë  ë•Œê¹Œì§€ ë©”ëª¨ë¦¬ì— ì €ì¥í•´ë†“ê³  ì¬ì‚¬ìš©í•  ìˆ˜ ìˆê²Œ í•´ì¤€ë‹¤.   

## useCallback. ì–¸ì œ ì“°ì´ëŠ”ê°€?
ë‹¤ìŒê³¼ ê°™ì€ ìƒí™©ì„ ìƒê°í•´ë³´ì.

``` javascript
import React, { useState, useEffect } from "react"

function Profile({ userId }) {
  const [user, setUser] = useState(null)

  const fetchUser = () =>
    fetch(`https://jsonplaceholder.com/users/${userId}`)
      .then((response) => response.json())
      .then(({ user }) => user)

  useEffect(() => {
    fetchUser().then((user) => setUser(user))
  }, [fetchUser])

  // ...
}
```

ìœ„ì˜ ì½”ë“œëŠ” ë¬´í•œ ë£¨í”„ì— ë¹ ì§€ê²Œ ë˜ëŠ”ë° ê·¸ ê³¼ì •ì€ ë‹¤ìŒê³¼ ê°™ë‹¤.
1. APIë¥¼ í˜¸ì¶œí•˜ëŠ” fetchUser í•¨ìˆ˜ê°€ ë©”ëª¨ë¦¬ì— í• ë‹¹ëœë‹¤. 
2. ê·¸ê²ƒìœ¼ë¡œ ì¸í•´ useEffect í›…ì´ ì‹¤í–‰ëœë‹¤. 
3. effect ì•ˆì— setUser()ê°€ ìˆê¸°ë•Œë¬¸ì— Profile ì»´í¬ë„ŒíŠ¸ë¥¼ ë¦¬ë Œë”ë§í•œë‹¤.
4. **(ë°˜ë³µ)** fetchUserê°€ ì •ì˜ëœë‹¤.
5. **(ë°˜ë³µ)** ê·¸ê²ƒìœ¼ë¡œ ì¸í•´ useEffect í›…ì´ ì‹¤í–‰ëœë‹¤.
6. **(ë°˜ë³µ)** effect ì•ˆì— setUser()ê°€ ìˆê¸° ë•œì— Profile ì»´í¬ë„ŒíŠ¸ë¥¼ ë¦¬ë Œë”ë§í•œë‹¤.
7. ...

* ì—¬ê¸°ì„œ í‚¤ í¬ì¸íŠ¸ëŠ” ì•„ë¬´ë¦¬ ë˜‘ê°™ì€ í•¨ìˆ˜ fetchUserë¥¼ ì„ ì–¸í•˜ë”ë¼ë„ ì´ëŠ” ë©”ëª¨ë¦¬ ìƒì—ì„œ í•­ìƒ ë‹¤ë¥¸ ìœ„ì¹˜ë¥¼ í• ë‹¹ë°›ê¸° ë•Œë¬¸ì— useEffectì˜ ì˜ì¡´ ë°°ì—´ì¸ fetchUserì˜ ì°¸ì¡°ê°’ì´ ë°”ë€Œì–´ì„œ ì˜ˆìƒì¹˜ ëª»í•œ ë¬´í•œë£¨í”„ë¥¼ ë§Œë“¤ê²Œ ëœë‹¤.

## í•´ê²°ë°©ë²• (useCallback)

``` javascript
import React, { useState, useEffect, useCallback } from "react"

function Profile({ userId }) {
  const [user, setUser] = useState(null)

  const fetchUser = useCallback(() => {
    fetch(`https://jsonplaceholder.com/users/${userId}`)
      .then(response => response.json())
      .then({ user } => user)
  }, [userId])
  
  useEffect(() => {
    fetchUser().then((user) => setUser(user))
  }, [fetchUser])

  // ...
}
```
* **useCallback** hook í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•´ì„œ ì»´í¬ë„ŒíŠ¸ê°€ ë¦¬ë Œë”ë§ì´ ë˜ë”ë¼ë„ fetchUser í•¨ìˆ˜ì˜ ì°¸ì¡°ê°’ì„ ë™ì¼í•˜ê²Œ ìœ ì§€ì‹œí‚¬ ìˆ˜ ìˆë‹¤. ì´ í•¨ìˆ˜ëŠ” ì˜¤ì§ ì˜ì¡´ê°’ì¸ userId ê°€ ë³€ê²½ë  ë•Œë§Œ ë©”ëª¨ë¦¬ì— ë‹¤ì‹œ í• ë‹¹ëœë‹¤. useCallback í›…ì„ ì´ìš©í•¨ìœ¼ë¡œì¨ ë¬´í•œ ë£¨í”„ì—ì„œ ë²—ì–´ë‚˜ í”„ë¡œê·¸ë˜ë¨¸ì˜ ê´€ì ëŒ€ë¡œ ì½”ë“œê°€ ì‹¤í–‰ëœë‹¤.


## React memo (with useCallback)
Reactê°€ DOMì„ ì—…ë°ì´íŠ¸í•˜ëŠ” ë°©ë²•ì€ ì¼ë‹¨ ì»´í¬ë„ŒíŠ¸ë¥¼ ë Œë”ë§í•˜ê³ , ì´ì „ ë Œë”ë§ëœ ê²°ê³¼ì™€ ë¹„êµí•˜ì—¬ ë‹¤ë¥´ë‹¤ë©´ ReactëŠ” DOMì„ ì—…ë°ì´íŠ¸í•œë‹¤. ê·¸ëŸ°ë° ì´ë¥¼ ë” ìµœì í™”í•  ìˆ˜ëŠ” ì—†ì„ê¹Œ? ì»´íŒŒì¼ì„ í•  ë•Œ ë§ˆë‹¤ ëª¨ë“  ì»´í¬ë„ŒíŠ¸ë¥¼ **ìƒˆë¡­ê²Œ ëœë”ë§í•˜ê³ ** **ì´ì „ ì»´í¬ë„ŒíŠ¸ì˜ ë Œë”ë§ ê²°ê³¼ì™€ ë¹„êµ** í•˜ëŠ” Overheadë¥¼ ì¤„ì¼ ìˆ˜ ìˆì§€ ì•Šì„ê¹Œ?

ì—¬ê¸°ì„œ ì•„ë¦„ë‹¤ìš´ React.memoê°€ íƒ„ìƒí–ˆë‹¤. React.memoëŠ” ìµœì´ˆì˜ ì»´í¬ë„ŒíŠ¸ë¥¼ ë Œë”ë§í•˜ê³  ë©”ëª¨ì´ì§•í•œë‹¤. ê·¸ë¦¬ê³  ë‹¤ìŒ ë Œë”ë§ì´ ì¼ì–´ë‚  ë•Œ propsë¥¼ [ì–•ì€ë¹„êµ](https://ko.reactjs.org/docs/shallow-compare.html) í•˜ì—¬ ê°™ë‹¤ë©´ ë©”ëª¨ì´ì§•(Memoizing)ëœ ê²°ê³¼ë¥¼ ì¬ì‚¬ìš©í•œë‹¤.
   
ë‹¤ìŒê³¼ ê°™ì€ 3ê°œì˜ ì¸ì‚¬ Robot ì»´í¬ë„ŒíŠ¸ë¥¼ ë§Œë“œëŠ” Factory ì»´í¬ë„ŒíŠ¸ë¥¼ ê³ ë ¤í•´ë³´ì.
``` javascript
import React, {useState} from 'react';
import Robot from './Robot';
export default function Factory() {
  const [greetingA, setGreetingA] = useState(false)
  const [greetingB, setGreetingB] = useState(false)
  const [greetingC, setGreetingC] = useState(false)

  const toggleA = () => setGreetingA(!greetingA)
  const toggleB = () => setGreetingB(!greetingB)
  const toggleC = () => setGreetingC(!greetingC)

  return (
    <>
      <Robot name="A" isGreeting={greetingA} toggle={toggleA} />
      <Robot name="B" isGreeting={greetingB} toggle={toggleB} />
      <Robot name="C" isGreeting={greetingC} toggle={toggleC} />
    </>
  )
} 

```

ê·¸ë¦¬ê³  ë°‘ì—ëŠ” Robot ì»´í¬ë„ŒíŠ¸ë‹¤. ì´ ì»´í¬ë„ŒíŠ¸ë¥¼ React.Memoë¡œ ê°ì‹¸ì£¼ë©´ ë Œë”ë§ì˜ ê²°ê³¼ëŠ” ë©”ëª¨ì´ì§• ëœë‹¤. propsê°€ ë³€ê²½ë˜ì§€ ì•ŠëŠ” í•œ ë‹¤ì‹œ í˜¸ì¶œë˜ì§€ ì•ŠëŠ”ë‹¤.

``` javascript
import React, {useState} from 'react';

function Robot({ name, isGreeting, toggle}) {
  console.log({ name, greeting })
  return (
    <>
      <button onClick={toggle}>
        {name} {isGreeting? ğŸ™‰ : ğŸ™ˆ}
      </button>
    </>
  )
} 
export default memoizedRobot = React.Memo(Robot) 
```

ê·¸ëŸ°ë°, ì´ë•Œ ë¡œë´‡ Aì—ê²Œë§Œ ì¸ì‚¬ë¥¼ ì‹œì¼°ëŠ”ë° ì½˜ì†”ì´ ì¡°ê¸ˆ ì´ìƒí•˜ë‹¤.
```javascript
{name: "A", greeting: "true"}
{name: "B", greeting: "false"}
{name: "C", greeting: "false"}
```   

ë¶„ëª… ë¡œë´‡ Aì˜ propsë§Œ ë³€ê²½ì‹œí‚¨ ê²ƒ ê°™ì€ë°, ì™œ 
React.memoë¥¼ ì¼ëŠ”ë°ë„ ë³€í™”ì—†ëŠ” ë¡œë´‡ B, Cë„ ë Œë”ë§ë˜ëŠ”ê°€?
<br />

ê·¸ë ‡ë‹¤. ì¼ì „ê³¼ ê°™ì€ ì´ìœ ì´ë‹¤. ë Œë”ë§ë  ë•Œë§ˆë‹¤ ê° í•¨ìˆ˜ì˜ ì°¸ì¡°ê°’ì´ ë³€ê²½ë¼ì„œ propsê°€ ë³€ê²½ëœ ê²ƒì´ê³  React.memoê°€  ë©”ëª¨ì´ì§•í•œ ë Œë”ë§ê³¼ ë‹¬ë¼ì§€ë¯€ë¡œ ë‹¤ì‹œ ë˜ ë Œë”ë§í•œ ê²ƒì´ë‹¤.

## í•´ê²°ë°©ë²• (useCallback)

``` javascript
import React, {useState} from 'react';

export default function Factory() {
  const [greetingA, setGreetingA] = useState(false)
  const [greetingB, setGreetingB] = useState(false)
  const [greetingC, setGreetingC] = useState(false)

  const toggleA = () => useCallback(() => setGreetingA(!greetingA), [greetingA])
  const toggleB = () => useCallback(() => setGreetingB(!greetingB), [greetingB])
  const toggleC = () => useCallback(() => setGreetingC(!greetingC), [greetingC])

  return (
    <>
      <Robot name="A" isGreeting={greetingA} toggle={toggleA} />
      <Robot name="B" isGreeting={greetingB} toggle={toggleB} />
      <Robot name="C" isGreeting={greetingC} toggle={toggleC} />
    </>
  )
} 

```
<br />
ìœ„ì™€ ê°™ì´ useCallbackì„ ì‚¬ìš©í•˜ë©´ ë Œë”ë§ ë§ˆë‹¤ ì½œë°±í•¨ìˆ˜ì˜ ì°¸ì¡°ê°’ì„ ìœ ì§€ì‹œí‚¬ ìˆ˜ ìˆê³  ê²°ê³¼ì ìœ¼ë¡œ ë¡œë´‡ Aë¥¼ í´ë¦­í•˜ë©´ Aì— ëŒ€í•œ Robot ì»´í¬ë„ŒíŠ¸ë§Œ í˜¸ì¶œë˜ëŠ” ê²ƒì„ ë³¼ ìˆ˜ ìˆë‹¤.

```javascript
{romm: A, isGreeting: true}
```

<br />

## ê·¸ëŸ¬ë‚˜ ë‚¨ìš©í•˜ë©´ ì—­íš¨ê³¼ê°€ ìƒê¸´ë‹¤.
ëª¨ë“  ê²ƒì—ëŠ” trade-offê°€ ìˆê¸° ë§ˆë ¨ì´ë‹¤. ë¶ˆí•„ìš”í•œ ë Œë”ë§ì„ ë§‰ì•„ì£¼ê¸´ í•˜ì§€ë§Œ ì½”ë“œê°€ ë³µì¡í•´ì§€ê³  ìœ ì§€ë³´ìˆ˜ê°€ í˜ë“¤ì–´ì§„ë‹¤.
ê·¸ëŸ¬ë¯€ë¡œ ê°™ì€ propsë¥¼ ë„˜ê²¨ì¤„ ì¼ì´ ë§ì€ ì»´í¬ë„ŒíŠ¸ë¥¼ ì‚¬ìš©í•  ë•Œë§Œ ê³ ë ¤í•˜ëŠ” ê²ƒì´ ì¢‹ë‹¤.

ì°¸ê³ ìë£Œ : [https://www.daleseo.com/react-hooks-use-callback/](https://www.daleseo.com/react-hooks-use-callback/)
[https://ko.reactjs.org/docs/shallow-compare.html](https://ko.reactjs.org/docs/shallow-compare.html)